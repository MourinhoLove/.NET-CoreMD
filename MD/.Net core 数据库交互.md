# .Net core 数据库交互

## 选择ORM框架

### 1.EF Core

这是官方亲儿子，推荐使用

### 2.Dapper

这是第三方之中最有名的一个。也可以考虑试试

## EF使用教程

这里有两种驱动方式。一种是我用代码去创建数据库。一种是我先建好数据库，再用代码去访问。这里介绍第二种方法。第一种暂时还没好好研究

### 1.创建对应的model

### 2.注册上下文

### 3.在入口进行依赖注入

### 4.在服务或者控制器的构造函数中得到数据库对象

### 5.查询语句

#### - 查询所有

```c#
public List<Person> getAll()
{
    using (_dbcontex)
    {
        var list = _dbcontex.People
             .FromSqlRaw("SELECT * FROM user.people")
             .ToList();
        return list;
    }
}
```

#### - 根据用户输入 查询相关内容

```c#
public bool login(string name, string password)
{
    using (_dbcontex)
    {
        var list = _dbcontex.People
            .FromSqlInterpolated($@"select * 
                                    from user.people 
                                    where Name = {name} and Password = {password}")
            .ToList();
        if (!list.Any())
        {
            return false;
        } else
        {
            return true;
        }
    }

}
```

`ToList()` :返回的是一个查询的数组

`FromSqlRaw` : 最普通的查询方式

`FromSqlInterpolated` : 适用于根据参数进行查询

#### -SQL的写法

>```c#
>.FromSqlInterpolated($@"select * 
>                        from user.people 
>                        where Name = {name} 
>                        and Password = {password}")
>```
>
>这里记得用FromSqlInterpolated的时候 要添加`$`
>
>`@`用于创造一个可以换行的字符串

详情可以参考[官网的链接](**https://docs.microsoft.com/zh-cn/ef/core/querying/raw-sql**)



